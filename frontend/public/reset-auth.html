<!DOCTYPE html>
<html>
  <head>
    <title>Blood Warriors - Auth Reset</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background: #f5f5f5;
      }
      .container {
        max-width: 600px;
        margin: 0 auto;
        background: white;
        padding: 20px;
        border-radius: 8px;
      }
      button {
        background: #dc2626;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        margin: 5px;
      }
      button:hover {
        background: #b91c1c;
      }
      .success {
        color: #16a34a;
      }
      .info {
        color: #2563eb;
      }
      pre {
        background: #f3f4f6;
        padding: 10px;
        border-radius: 4px;
        overflow-x: auto;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ðŸ©¸ Blood Warriors - Authentication Reset</h1>
      <p>Use this page to debug and reset authentication issues.</p>

      <h3>Current Auth State:</h3>
      <pre id="authState">Loading...</pre>

      <h3>Actions:</h3>
      <button onclick="checkAuthState()">Check Auth State</button>
      <button onclick="clearTokens()">Clear All Tokens</button>
      <button onclick="goToApp()">Go to App</button>

      <div id="messages"></div>
    </div>

    <script>
      function log(message, type = "info") {
        const messages = document.getElementById("messages");
        const div = document.createElement("div");
        div.className = type;
        div.innerHTML = `<p>${message}</p>`;
        messages.appendChild(div);
      }

      function checkAuthState() {
        const accessToken = localStorage.getItem("blood_warriors_access_token");
        const refreshToken = localStorage.getItem(
          "blood_warriors_refresh_token"
        );

        let tokenInfo = "No tokens found";

        if (accessToken) {
          try {
            const payload = JSON.parse(atob(accessToken.split(".")[1]));
            const isExpired = payload.exp < Date.now() / 1000;
            tokenInfo = `Access Token: ${isExpired ? "EXPIRED" : "VALID"}
User: ${payload.email || "Unknown"}
Type: ${payload.userType || "Unknown"}
Expires: ${new Date(payload.exp * 1000).toLocaleString()}`;
          } catch (e) {
            tokenInfo = "Access Token: INVALID FORMAT";
          }
        }

        document.getElementById("authState").textContent = `
Access Token: ${accessToken ? "Present" : "None"}
Refresh Token: ${refreshToken ? "Present" : "None"}

${tokenInfo}`;
      }

      function clearTokens() {
        localStorage.removeItem("blood_warriors_access_token");
        localStorage.removeItem("blood_warriors_refresh_token");
        log("âœ… All authentication tokens cleared", "success");
        checkAuthState();
      }

      function goToApp() {
        window.location.href = "/";
      }

      // Check auth state on load
      checkAuthState();
    </script>
  </body>
</html>
